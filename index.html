<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–∞–≥–∞–∑–∏–Ω –∫–æ—Å–º–µ—Ç–∏–∫–∏</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f7f7f7;
            margin: 0;
            padding: 10px;
        }
        h2 {
            text-align: center;
        }
        .product {
            background: white;
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        .product img {
            width: 80px;
            height: 80px;
            border-radius: 8px;
            margin-right: 10px;
        }
        .product-info {
            flex: 1;
        }
        .product-title {
            font-size: 16px;
            font-weight: bold;
        }
        .price {
            color: #ff4081;
            margin: 5px 0;
        }
        .btn {
            background: #ff4081;
            color: white;
            padding: 5px 10px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }
        #cart-summary {
            background: #fff8e1;
            padding: 10px;
            border-radius: 8px;
            font-size: 16px;
            margin: 15px 0;
        }
        #checkout {
            background: #28a745;
            color: white;
            padding: 10px;
            font-size: 16px;
            width: 100%;
            border: none;
            border-radius: 8px;
        }
    </style>
</head>
<body>

    <h2>üõç –í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä—ã</h2>
    <div id="product-list"></div>

    <!-- ‚úÖ –ë–ª–æ–∫ —Å –∏—Ç–æ–≥–æ–≤–æ–π —Å—É–º–º–æ–π -->
    <div id="cart-summary">üõí –í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</div>

    <!-- ‚úÖ –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–∫–∞–∑–∞ -->
    <button id="checkout">‚úÖ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑</button>

    <script>
        // ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp API
        const tg = window.Telegram.WebApp;

        // ‚úÖ –ö–æ—Ä–∑–∏–Ω–∞
        let cart = [];

        // ‚úÖ –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
        let products = [
            { name: "TIGI Balm 12", price: 3000, img: "tigi12.jpg" },
            { name: "TIGI Balm 13", price: 3100, img: "tigi13.jpg" },
            { name: "TIGI Balm 14", price: 3200, img: "tigi14.jpg" },
            { name: "TIGI Balm 15", price: 3300, img: "tigi15.jpg" }
        ];

        // ‚úÖ –†–µ–Ω–¥–µ—Ä–∏–º —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
        function renderProducts() {
            const list = document.getElementById('product-list');
            list.innerHTML = "";
            products.forEach(p => {
                const div = document.createElement('div');
                div.className = "product";
                div.innerHTML = `
                    <img src="${p.img}" alt="${p.name}">
                    <div class="product-info">
                        <div class="product-title">${p.name}</div>
                        <div class="price">${p.price} ‚ÇΩ</div>
                        <button class="btn" onclick="addToCart('${p.name}', ${p.price})">–î–æ–±–∞–≤–∏—Ç—å</button>
                    </div>
                `;
                list.appendChild(div);
            });
        }

        // ‚úÖ –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—É–º–º—ã –≤ –∫–æ—Ä–∑–∏–Ω–µ
        function updateCartSummary() {
            let total = 0;
            cart.forEach(item => total += item.price);
            const summary = document.getElementById("cart-summary");
            if (cart.length === 0) {
                summary.textContent = "üõí –í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞";
            } else {
                summary.textContent = 'üõí –¢–æ–≤–∞—Ä–æ–≤: ${cart.length} | üí∞ –ò—Ç–æ–≥–æ: ${total} \u20BD';
            }
        }

        // ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É
        function addToCart(name, price) {
            cart.push({ name, price });

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—É–º–º—É
            updateCartSummary();

            // –í–∏–±—Ä–∞—Ü–∏—è + –≤—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ
            tg.HapticFeedback.notificationOccurred("success");
            tg.showPopup({
                title: "–ö–æ—Ä–∑–∏–Ω–∞",
                message: '${name} –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É!',
                buttons: [{ text: "–û–∫" }]
            });
        }

        // ‚úÖ –ö–Ω–æ–ø–∫–∞ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑"
        document.getElementById("checkout").addEventListener("click", () => {
            if (cart.length === 0) {
                tg.showAlert("–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞!");
                return;
            }

            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–æ—Ä–∑–∏–Ω—É –≤ –±–æ—Ç
            Telegram.WebApp.sendData(JSON.stringify(cart));

            // –ó–∞–∫—Ä—ã–≤–∞–µ–º WebApp
            Telegram.WebApp.close();
        });

        // ‚úÖ –ó–∞–ø—É—Å–∫
        renderProducts();
        updateCartSummary();
    </script>
</body>
</html>
